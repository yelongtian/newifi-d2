<!DOCTYPE html>
<html>
<head>
    <title>Flashing - MediaTek System Recovery Mode</title>
    <link rel="stylesheet" type="text/css" href="/style.css">
    <script src="/script.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <style>
        /* Loading spinner */
        #main .loading-spinner {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 4px solid transparent;
            border-top-color: currentColor;
            border-right-color: currentColor;
            animation: msr-spin 0.8s linear infinite;
            margin: 16px auto;
            opacity: 0.9;
        }
        @keyframes msr-spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="controls">
        <div class="select-container">
            <select id="language-selector">
                <option value="en">English</option>
                <option value="zh">中文</option>
            </select>
        </div>
        <div class="select-container">
            <select id="theme-selector">
                <option value="auto" data-i18n="theme_auto">Auto</option>
                <option value="light" data-i18n="theme_light">Light</option>
                <option value="dark" data-i18n="theme_dark">Dark</option>
            </select>
        </div>
    </div>
    <div id="banner" data-i18n="banner">
        MediaTek U-Boot System Recovery Mode
    </div>
    <div id="main">
        <p data-i18n="upgrading">Upgrading is in progressing, please wait ...</p>
        <div class="loading-spinner" role="status" aria-label="Loading"></div>
        <p data-i18n="page_status">This page may be in not responding status for a short time.</p>
    </div>
    <script type="text/javascript">
        var interval = window.setInterval(function () {
            var xmlhttp = new XMLHttpRequest();

            window.clearInterval(interval);

            xmlhttp.timeout = 300000;
            xmlhttp.open("GET", "/result", true);
            xmlhttp.send();
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    document.getElementById("main").innerHTML = xmlhttp.responseText;
                    // 重新应用语言翻译
                    if (typeof applyLanguage === 'function') {
                        applyLanguage();
                    }
                }
            }
        }, 1000);
    </script>
</body>
</html>